# 0. 反向代理介绍

**反向代理工作原理**：当客户端发送请求给**反向代理服务器**时，该反向代理服务器并没有真正的请求资源，也不会直接响应客户端的请求，而是在反向代理服务器本地再次生成一个请求发送给真正拥有资源的**后端服务器**。然后后端服务器会将资源响应给反向代理服务器，反向代理服务器再将资源返回给客户端。

**反向代理的优点**：反向代理可以隐藏内网主机的真正IP地址，起到安全的作用；反向代理服务器可以缓存请求到的资源，减轻后端服务器的访问压力。

**反向代理的缺点**：反向代理的缺点就在于其并发能力相对NAT模型弱，因为它对于后端服务器的请求是需要使用套接字的，在不开启保持连接的模式下，反代服务器（反向代理服务器）每接收到一个请求都会使用一个套接字跟后端做连接，而套接字的数量是有上限的。

# 1. Nginx反向代理介绍

Nginx有多种反向代理功能，并且设立了多种反向代理的模块。

| 反向代理模块             | 功能                                                         |
| ------------------------ | ------------------------------------------------------------ |
| ngx_http_proxy_module    | 用来反向代理http的请求                                       |
| ngx_http_headers_module  | 将代理服务器响应给客户端的报文中添加自定义首部，也可以修改原来首部的值 |
| ngx_http_fastcgi_module  | 用来反向代理fastcgi的请求，可以用来构建LAMP模型              |
| ngx_http_upstream_module | 定义server组，这些组可以在反代时引用，以实现负载均衡         |
| ngx_stream_core_module   | 可以实现传输层的反向代理                                     |

